<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration - Ajouter un point</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
    <style>
        #admin-map { height: 300px; margin-bottom: 20px; border-radius: 8px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 4px; cursor: pointer; }
        #json-output { background: #f8f9fa; padding: 15px; border: 1px solid #ddd; border-radius: 4px; white-space: pre-wrap; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ajouter un nouveau point sur la carte</h1>
        <p>1. Cliquez sur la carte pour définir les coordonnées.</p>
        <div id="admin-map"></div>
        
        <form id="point-form">
            <div class="form-group">
                <label>Latitude</label>
                <input type="text" id="lat" readonly>
            </div>
            <div class="form-group">
                <label>Longitude</label>
                <input type="text" id="lng" readonly>
            </div>
            <div class="form-group">
                <label>Titre</label>
                <input type="text" id="title" required>
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="description" rows="4"></textarea>
            </div>
            <div class="form-group">
                <label>URL de l'image</label>
                <input type="text" id="image" placeholder="https://...">
            </div>
            <div class="form-group">
                <label>Lien (Site web)</label>
                <input type="text" id="link" placeholder="https://...">
            </div>
            <button type="submit">Générer l'entrée JSON</button>
        </form>

        <div id="result-section" style="display:none;">
            <h2>Entrée JSON</h2>
            <p>Copiez et ajoutez ceci à votre fichier <code>data.json</code> :</p>
            <div id="json-output"></div>
        </div>
        <br>
        <a href="index.html">Voir la carte</a>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const map = L.map('admin-map').setView([49.1667, 5.0000], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        let marker;
        map.on('click', function(e) {
            if (marker) map.removeLayer(marker);
            marker = L.marker(e.latlng).addTo(map);
            document.getElementById('lat').value = e.latlng.lat.toFixed(6);
            document.getElementById('lng').value = e.latlng.lng.toFixed(6);
        });

        document.getElementById('point-form').onsubmit = function(e) {
            e.preventDefault();
            const newPoint = {
                id: Date.now(),
                lat: parseFloat(document.getElementById('lat').value),
                lng: parseFloat(document.getElementById('lng').value),
                title: document.getElementById('title').value,
                description: document.getElementById('description').value,
                image: document.getElementById('image').value,
                link: document.getElementById('link').value
            };
            
            const output = document.getElementById('json-output');
            output.innerText = JSON.stringify(newPoint, null, 2) + ",";
            document.getElementById('result-section').style.display = 'block';
        };
    </script>
</body>
</html>